<!DOCTYPE html>
<html lang="id">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <title>Wazuh — SIEM Dokumentasi Lengkap</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet" />
    <link rel="stylesheet" href="style.css" />
  </head>
  <body>
    <header class="header-area"><div class="container py-3"><a href="index.html" class="logo text-decoration-none"><h1 class="m-0">Blog Praktikum</h1></a></div></header>
    <main class="section"><div class="container">
      <h1>Wazuh SIEM — Dokumentasi Lengkap</h1>
      <p class="lead">Dokumentasi komprehensif Wazuh dari materi praktikum: overview, fitur, arsitektur, instalasi lengkap, konfigurasi, usage, troubleshooting, dan best practices.</p>

      <section class="mt-3">
        <h4>Overview</h4>
        <p>Wazuh adalah unified XDR (Extended Detection and Response) dan SIEM (Security Information and Event Management) platform open-source yang digunakan untuk threat detection, integrity monitoring, incident response, dan compliance. Wazuh melindungi workloads di on-premise, virtualized, container, dan cloud environments.</p>
      </section>

      <section class="mt-3">
        <h4>Features</h4>
        <ul>
          <li><strong>Security Analytics:</strong> Log analysis, intrusion detection, vulnerability detection</li>
          <li><strong>Threat Intelligence:</strong> Integration dengan threat intelligence feeds</li>
          <li><strong>File Integrity Monitoring (FIM):</strong> Mendeteksi perubahan pada file system</li>
          <li><strong>Configuration Assessment:</strong> Security configuration monitoring</li>
          <li><strong>Incident Response:</strong> Automated response capabilities</li>
          <li><strong>Regulatory Compliance:</strong> PCI DSS, HIPAA, GDPR compliance monitoring</li>
          <li><strong>Cloud Security:</strong> AWS, Azure, GCP security monitoring</li>
          <li><strong>Container Security:</strong> Docker dan Kubernetes monitoring</li>
        </ul>
      </section>

      <section class="mt-3">
        <h4>Architecture</h4>
        <p>Wazuh terdiri dari 3 komponen utama:</p>
        <ul>
          <li><strong>Wazuh Manager:</strong> Server yang menerima dan menganalisis data dari agents</li>
          <li><strong>Wazuh Agent:</strong> Lightweight agent yang diinstall pada endpoints</li>
          <li><strong>Elastic Stack:</strong> Elasticsearch, Filebeat, dan Kibana untuk data indexing dan visualization</li>
        </ul>
      </section>

      <section class="mt-3">
        <h4>Installation</h4>
        <h5>Prerequisites</h5>
        <p>Pastikan sistem Anda memenuhi:</p>
        <ul>
          <li>Ubuntu 20.04/22.04 atau Debian 10/11</li>
          <li>Minimal 4GB RAM (8GB+ recommended)</li>
          <li>Minimal 50GB disk space</li>
          <li>Root atau sudo access</li>
        </ul>

        <h5>Installation Steps</h5>
        <h6>1. Install Wazuh Manager</h6>
        <p><strong>Add Wazuh Repository</strong></p>
        <pre><code># Import GPG key
curl -s https://packages.wazuh.com/key/GPG-KEY-WAZUH | \
sudo gpg --no-default-keyring --keyring gnupg-ring:/usr/share/keyrings/wazuh.gpg --import

# Set permissions
sudo chmod 644 /usr/share/keyrings/wazuh.gpg

# Add repository
echo "deb [signed-by=/usr/share/keyrings/wazuh.gpg] https://packages.wazuh.com/4.x/apt/ stable main" | \
sudo tee -a /etc/apt/sources.list.d/wazuh.list
</code></pre>

        <p><strong>Install Wazuh Manager and Filebeat</strong></p>
        <pre><code># Update package list
sudo apt update

# Install Wazuh Manager and Filebeat
sudo apt install wazuh-manager filebeat -y
</code></pre>

        <p><strong>Verify Installation</strong></p>
        <pre><code># Check Wazuh Manager status
sudo systemctl status wazuh-manager

# Check Filebeat status
sudo systemctl status filebeat
</code></pre>

        <h6>2. Install Elasticsearch</h6>
        <p><strong>Add Elasticsearch Repository</strong></p>
        <pre><code># Import Elasticsearch GPG key
curl -s https://artifacts.elastic.co/GPG-KEY-elasticsearch | \
sudo gpg --no-default-keyring --keyring gnupg-ring:/usr/share/keyrings/elasticsearch.gpg --import

# Set permissions
sudo chmod 644 /usr/share/keyrings/elasticsearch.gpg

# Add Elasticsearch repository (version 7.x)
echo "deb [signed-by=/usr/share/keyrings/elasticsearch.gpg] https://artifacts.elastic.co/packages/7.x/apt stable main" | \
sudo tee -a /etc/apt/sources.list.d/elastic-7.x.list
</code></pre>

        <p><strong>Install Elasticsearch</strong></p>
        <pre><code># Update package list
sudo apt update

# Install Elasticsearch
sudo apt install elasticsearch -y
</code></pre>

        <p><strong>Configure and Start Elasticsearch</strong></p>
        <pre><code># Reload systemd daemon
sudo systemctl daemon-reload

# Enable Elasticsearch to start on boot
sudo systemctl enable elasticsearch.service

# Start Elasticsearch
sudo systemctl start elasticsearch.service
</code></pre>

        <p><strong>Verify Elasticsearch</strong></p>
        <pre><code># Check Elasticsearch status
sudo systemctl status elasticsearch

# Test Elasticsearch (wait ~30 seconds after start)
curl -X GET "localhost:9200"
</code></pre>

        <h6>3. Install Kibana with Wazuh Plugin</h6>
        <p><strong>Download and Install Kibana</strong></p>
        <pre><code># Download Kibana version 7.17.13
wget https://artifacts.elastic.co/downloads/kibana/kibana-7.17.13-amd64.deb

# Install Kibana
sudo dpkg -i kibana-7.17.13-amd64.deb

# Fix any dependency issues
sudo apt install -f -y
</code></pre>

        <p><strong>Set Proper Permissions</strong></p>
        <pre><code># Set ownership
sudo chown -R kibana:kibana /usr/share/kibana/

# Set permissions for plugins directory
sudo chmod 755 /usr/share/kibana/plugins/
</code></pre>

        <p><strong>Install Wazuh Kibana Plugin</strong></p>
        <pre><code># Download Wazuh Kibana plugin (version 4.5.3 for Kibana 7.17.13)
wget https://packages.wazuh.com/4.x/ui/kibana/wazuh_kibana-4.5.3_7.17.13-1.zip

# Install plugin as kibana user
sudo -u kibana /usr/share/kibana/bin/kibana-plugin install file://$(pwd)/wazuh_kibana-4.5.3_7.17.13-1.zip
</code></pre>

        <p><strong>Configure Kibana</strong></p>
        <pre><code># Edit Kibana configuration
sudo nano /etc/kibana/kibana.yml
</code></pre>

        <p>Tambahkan konfigurasi berikut:</p>
        <pre><code>server.port: 5601
server.host: "0.0.0.0"
elasticsearch.hosts: ["http://localhost:9200"]
</code></pre>

        <p><strong>Start Kibana</strong></p>
        <pre><code># Enable Kibana to start on boot
sudo systemctl enable kibana

# Start Kibana
sudo systemctl start kibana

# Check status
sudo systemctl status kibana
</code></pre>

        <h6>4. Configure Filebeat</h6>
        <pre><code># Download Filebeat configuration template
curl -so /etc/filebeat/filebeat.yml https://packages.wazuh.com/4.x/tpl/elastic-basic/filebeat.yml

# Download alerts template
curl -so /etc/filebeat/wazuh-template.json https://packages.wazuh.com/4.x/tpl/elastic-basic/wazuh-template.json

# Download Wazuh module for Filebeat
curl -s https://packages.wazuh.com/4.x/filebeat/wazuh-filebeat-0.2.tar.gz | sudo tar -xvz -C /usr/share/filebeat/module

# Restart Filebeat
sudo systemctl restart filebeat
</code></pre>
      </section>

      <section class="mt-3">
        <h4>Configuration</h4>
        <h5>Wazuh Manager Configuration</h5>
        <p>Edit /var/ossec/etc/ossec.conf:</p>
        <pre><code>&lt;ossec_config&gt;
  &lt;global&gt;
    &lt;jsonout_output&gt;yes&lt;/jsonout_output&gt;
    &lt;alerts_log&gt;yes&lt;/alerts_log&gt;
    &lt;logall&gt;no&lt;/logall&gt;
    &lt;email_notification&gt;no&lt;/email_notification&gt;
  &lt;/global&gt;

  &lt;syslog_output&gt;
    &lt;server&gt;127.0.0.1&lt;/server&gt;
    &lt;port&gt;514&lt;/port&gt;
    &lt;format&gt;json&lt;/format&gt;
  &lt;/syslog_output&gt;
&lt;/ossec_config&gt;
</code></pre>

        <h5>Agent Registration</h5>
        <p><strong>Generate Agent Key</strong></p>
        <pre><code># On Wazuh Manager
sudo /var/ossec/bin/manage_agents

# Select option 'A' to add agent
# Enter agent name and IP address
</code></pre>

        <p><strong>Install Agent on Linux</strong></p>
        <pre><code># On the agent machine
curl -s https://packages.wazuh.com/key/GPG-KEY-WAZUH | \
sudo gpg --no-default-keyring --keyring gnupg-ring:/usr/share/keyrings/wazuh.gpg --import

sudo chmod 644 /usr/share/keyrings/wazuh.gpg

echo "deb [signed-by=/usr/share/keyrings/wazuh.gpg] https://packages.wazuh.com/4.x/apt/ stable main" | \
sudo tee -a /etc/apt/sources.list.d/wazuh.list

sudo apt update
sudo apt install wazuh-agent -y

# Configure manager IP
sudo sed -i 's/MANAGER_IP/your_manager_ip/' /var/ossec/etc/ossec.conf

# Start agent
sudo systemctl start wazuh-agent
</code></pre>

        <h5>Access Wazuh Dashboard</h5>
        <p>Open browser and navigate to:</p>
        <pre><code>http://your_server_ip:5601
</code></pre>

        <p>Default credentials:</p>
        <ul>
          <li><strong>Username:</strong> admin</li>
          <li><strong>Password:</strong> Check /usr/share/wazuh-indexer/plugins/opensearch-security/securityconfig/internal_users.yml</li>
        </ul>

        <p>Navigate to Wazuh app from Kibana menu</p>
      </section>

      <section class="mt-3">
        <h4>Usage</h4>
        <h5>Monitoring Agents</h5>
        <pre><code># List all agents
sudo /var/ossec/bin/agent_control -l

# Check agent status
sudo /var/ossec/bin/agent_control -i &lt;agent_id&gt;
</code></pre>

        <h5>Viewing Alerts</h5>
        <pre><code># View recent alerts
sudo tail -f /var/ossec/logs/alerts/alerts.log

# View JSON alerts
sudo tail -f /var/ossec/logs/alerts/alerts.json
</code></pre>

        <h5>Managing Rules</h5>
        <pre><code># Custom rules location
/var/ossec/etc/rules/local_rules.xml

# Test rule syntax
sudo /var/ossec/bin/wazuh-logtest

# Restart after rule changes
sudo systemctl restart wazuh-manager
</code></pre>

        <h5>File Integrity Monitoring (FIM)</h5>
        <p>Add FIM configuration to /var/ossec/etc/ossec.conf:</p>
        <pre><code>&lt;syscheck&gt;
  &lt;disabled&gt;no&lt;/disabled&gt;
  &lt;frequency&gt;43200&lt;/frequency&gt;

  &lt;directories check_all="yes"&gt;/etc,/usr/bin,/usr/sbin&lt;/directories&gt;
  &lt;directories check_all="yes"&gt;/var/www&lt;/directories&gt;

  &lt;ignore&gt;/etc/mtab&lt;/ignore&gt;
  &lt;ignore&gt;/etc/hosts.deny&lt;/ignore&gt;
  &lt;ignore&gt;/etc/mail/statistics&lt;/ignore&gt;
&lt;/syscheck&gt;
</code></pre>

        <h5>Vulnerability Detection</h5>
        <p>Enable vulnerability detection in /var/ossec/etc/ossec.conf:</p>
        <pre><code>&lt;vulnerability-detector&gt;
  &lt;enabled&gt;yes&lt;/enabled&gt;
  &lt;interval&gt;5m&lt;/interval&gt;
  &lt;run_on_start&gt;yes&lt;/run_on_start&gt;

  &lt;provider name="canonical"&gt;
    &lt;enabled&gt;yes&lt;/enabled&gt;
    &lt;os&gt;trusty&lt;/os&gt;
    &lt;os&gt;xenial&lt;/os&gt;
    &lt;os&gt;bionic&lt;/os&gt;
    &lt;os&gt;focal&lt;/os&gt;
    &lt;update_interval&gt;1h&lt;/update_interval&gt;
  &lt;/provider&gt;
&lt;/vulnerability-detector&gt;
</code></pre>
      </section>

      <section class="mt-3">
        <h4>Common Commands</h4>
        <pre><code># Wazuh Manager
sudo systemctl start wazuh-manager
sudo systemctl stop wazuh-manager
sudo systemctl restart wazuh-manager
sudo systemctl status wazuh-manager

# Elasticsearch
sudo systemctl start elasticsearch
sudo systemctl status elasticsearch

# Kibana
sudo systemctl start kibana
sudo systemctl status kibana

# Filebeat
sudo systemctl start filebeat
sudo systemctl status filebeat

# View logs
sudo tail -f /var/ossec/logs/ossec.log
sudo journalctl -u wazuh-manager -f

# Agent management
sudo /var/ossec/bin/agent_control -l
sudo /var/ossec/bin/manage_agents
</code></pre>
      </section>

      <section class="mt-3">
        <h4>Troubleshooting</h4>
        <h5>Wazuh Manager Not Starting</h5>
        <pre><code># Check logs
sudo tail -f /var/ossec/logs/ossec.log

# Verify configuration
sudo /var/ossec/bin/wazuh-control info

# Check port 1514 (agent connection)
sudo netstat -tulpn | grep 1514
</code></pre>

        <h5>Elasticsearch Issues</h5>
        <pre><code># Check Elasticsearch logs
sudo journalctl -u elasticsearch -f

# Verify Elasticsearch is responding
curl -X GET "localhost:9200/_cluster/health?pretty"

# Check disk space
df -h
</code></pre>

        <h5>Kibana Cannot Connect to Elasticsearch</h5>
        <pre><code># Verify Kibana configuration
sudo cat /etc/kibana/kibana.yml | grep elasticsearch.hosts

# Check Kibana logs
sudo journalctl -u kibana -f

# Verify network connectivity
curl -X GET "localhost:9200"
</code></pre>

        <h5>Agent Not Connecting</h5>
        <pre><code># On agent, check manager IP
sudo cat /var/ossec/etc/ossec.conf | grep address

# Check agent logs
sudo tail -f /var/ossec/logs/ossec.log

# Verify firewall allows port 1514
sudo ufw allow 1514/tcp

# On manager, check agent status
sudo /var/ossec/bin/agent_control -l
</code></pre>

        <h5>Filebeat Not Sending Data</h5>
        <pre><code># Check Filebeat status
sudo systemctl status filebeat

# Test Filebeat configuration
sudo filebeat test config

# Check Filebeat logs
sudo journalctl -u filebeat -f

# Restart Filebeat
sudo systemctl restart filebeat
</code></pre>
      </section>

      <section class="mt-3">
        <h4>Performance Tuning</h4>
        <h5>Elasticsearch Memory</h5>
        <p>Edit /etc/elasticsearch/jvm.options:</p>
        <pre><code># Set heap size (50% of system RAM, max 32GB)
-Xms4g
-Xmx4g
</code></pre>

        <h5>Wazuh Manager Performance</h5>
        <p>Edit /var/ossec/etc/internal_options.conf:</p>
        <pre><code># Increase analysis threads
analysisd.threads=4

# Adjust queue size
analysisd.queue_size=131072
</code></pre>
      </section>

      <section class="mt-3">
        <h4>Security Best Practices</h4>
        <h5>Security Recommendations</h5>
        <ul>
          <li>Change default Kibana credentials immediately</li>
          <li>Enable HTTPS for Kibana (use nginx reverse proxy)</li>
          <li>Restrict network access to Kibana (firewall rules)</li>
          <li>Use authentication for Elasticsearch</li>
          <li>Regularly update Wazuh and Elastic Stack</li>
          <li>Monitor Wazuh logs for suspicious activities</li>
          <li>Implement proper backup strategy</li>
        </ul>
      </section>

      <section class="mt-3">
        <h4>Integration Examples</h4>
        <h5>Slack Integration</h5>
        <p>Edit /var/ossec/etc/ossec.conf:</p>
        <pre><code>&lt;integration&gt;
  &lt;name&gt;slack&lt;/name&gt;
  &lt;hook_url&gt;https://hooks.slack.com/services/YOUR/WEBHOOK/URL&lt;/hook_url&gt;
  &lt;level&gt;10&lt;/level&gt;
  &lt;alert_format&gt;json&lt;/alert_format&gt;
&lt;/integration&gt;
</code></pre>

        <h5>VirusTotal Integration</h5>
        <pre><code>&lt;integration&gt;
  &lt;name&gt;virustotal&lt;/name&gt;
  &lt;api_key&gt;YOUR_API_KEY&lt;/api_key&gt;
  &lt;rule_id&gt;87105&lt;/rule_id&gt;
  &lt;alert_format&gt;json&lt;/alert_format&gt;
&lt;/integration&gt;
</code></pre>
      </section>

      <section class="mt-3">
        <h4>Backup and Restore</h4>
        <h5>Backup Wazuh Configuration</h5>
        <pre><code># Backup Wazuh configuration
sudo tar -czf wazuh-backup-$(date +%Y%m%d).tar.gz \
  /var/ossec/etc/ \
  /var/ossec/rules/

# Backup Elasticsearch data
sudo tar -czf elasticsearch-backup-$(date +%Y%m%d).tar.gz \
  /var/lib/elasticsearch/
</code></pre>

        <h5>Restore Configuration</h5>
        <pre><code># Restore Wazuh configuration
sudo tar -xzf wazuh-backup-YYYYMMDD.tar.gz -C /

# Restart services
sudo systemctl restart wazuh-manager
</code></pre>
      </section>

      <div class="mt-4"><a class="btn btn-outline-primary" href="tools.html">← Kembali ke Security Tools</a></div>
    </div></main>
    <footer class="mt-5"><div class="container text-center small">&copy; 2025 Reinardus</div></footer>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
  </body>
</html>
